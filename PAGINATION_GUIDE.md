# MinerU PDF 翻页功能说明

## 功能概览

现在支持三种翻页方式：

### 1. ⬅️ 上一页按钮
- 点击跳转到上一页
- 在第 1 页时自动停留在第 1 页
- 自动更新滑块位置

### 2. ➡️ 下一页按钮
- 点击跳转到下一页
- 自动更新滑块位置
- 支持连续点击快速翻页

### 3. 📊 页码滑块
- 拖动滑块快速跳转到任意页
- 显示当前页码/总页数
- 支持精确定位

## 界面布局

```
┌─────────────────────────────────────────┐
│  🔄 加载分页预览                         │
├─────────────────────────────────────────┤
│  ⬅️ 上一页  ━━━━◉━━━━  ➡️ 下一页       │
│             页码滑块                     │
│         第 1 / 10 页                     │
├─────────────────────────────────────────┤
│                                          │
│         PDF 预览区域                     │
│      (带彩色 bbox 标注)                  │
│                                          │
└─────────────────────────────────────────┘
```

## 使用流程

1. **上传 PDF**
   - 选择 PDF 文件
   - 配置 MinerU 参数
   - 点击"提交 PDF 处理"

2. **等待解析**
   - 监控任务状态
   - 等待状态变为 `completed`

3. **加载预览**
   - 点击"🔄 加载分页预览"按钮
   - 等待第一页渲染完成

4. **浏览页面**
   - **方式 A**: 点击"⬅️ 上一页"或"➡️ 下一页"按钮
   - **方式 B**: 拖动滑块到目标页码
   - **方式 C**: 点击滑块直接输入页码

## 技术实现

### 按钮功能

```python
def _go_prev_page(task_id, current_page):
    """跳转到上一页，最小为第 1 页"""
    prev_page = max(1, int(current_page) - 1)
    return _update_page_view(task_id, prev_page)

def _go_next_page(task_id, current_page):
    """跳转到下一页，自动限制最大页数"""
    next_page = int(current_page) + 1
    return _update_page_view(task_id, next_page)
```

### 事件绑定

- `mineru_prev_btn.click()`: 上一页按钮
- `mineru_next_btn.click()`: 下一页按钮
- `mineru_page_slider.change()`: 滑块变化

### 状态同步

所有翻页操作都会同步更新：
- PDF 预览内容
- 页码信息显示
- 滑块位置
- Bbox 标注信息

## 错误处理

- ✅ 页码超出范围：自动限制在有效范围内
- ✅ 任务 ID 缺失：提示先加载预览
- ✅ 渲染失败：显示错误信息，保持当前页码
- ✅ 网络异常：显示详细错误和堆栈跟踪

## 性能优化

- 📦 **按需渲染**: 只生成当前查看的页面
- 💾 **文件缓存**: 生成的 PDF 保存在临时目录
- 🔄 **状态保持**: 滑块和页码信息实时同步
- ⚡ **快速切换**: 按钮点击无延迟响应

## 快捷键建议

未来可以添加键盘快捷键：
- `←` 或 `PageUp`: 上一页
- `→` 或 `PageDown`: 下一页
- `Home`: 第一页
- `End`: 最后一页

## 常见问题

### Q: 为什么点击按钮没反应？
A: 确保已经点击"🔄 加载分页预览"按钮初始化预览

### Q: 如何快速跳转到指定页？
A: 点击滑块轨道或直接拖动滑块到目标位置

### Q: 按钮和滑块可以同时使用吗？
A: 可以！它们会自动同步状态

### Q: 翻页速度慢怎么办？
A: 首次渲染需要生成 bbox 标注，后续切换会更快

## 更新日志

### 2024-12-06
- ✅ 新增"⬅️ 上一页"按钮
- ✅ 新增"➡️ 下一页"按钮
- ✅ 优化页码信息显示（居中对齐）
- ✅ 改进滑块布局（调整比例）
- ✅ 添加完整的错误处理
- ✅ 优化翻页逻辑和状态同步
